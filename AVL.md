# AVL
- AVL综合了二叉搜索树章节的几乎所有知识点，这一整个章节（BST）的PPT我已经全部看一遍了。
- 每个节点有一个参数叫作平衡因子，它是左孩子的高度减去右孩子的高度。在一棵AVL树中，限制每个节点的平衡因子只能是0,1或-1. 这样的话，左子树和右子树差不多高，AVL树虽然未必理想平衡，但必然渐近平衡。
- 高度为h的AVL树，至少包含$S(h)=fib(h+3)-1$个节点.
  - 反过来，由n个节点构成的AVL树，高度不超过$O(\log n)$

- 插入：从**祖父**开始，每个祖先都有可能失衡，且可能同时失衡！因此，需要从祖父开始逐层向上检查是否失衡并纠正，并从父亲开始逐层向上更新高度。
- 删除：从**父亲**开始，每个祖先都有可能失衡，但至多一个！
  - 为什么？我猜是因为：对于某个节点来说，如果这个节点失衡了，那肯定是这个节点更短的那个子树被删除了节点（如果是长的子树删除节点，不会导致失衡）。但是，对于这个节点的父亲，祖父，曾祖父······来说，它们计算高度是根据更长的那个子树来计算的，而更长的那个子树并没有变动。



- （2010 期中）在AVL树中删除节点之后若树高降低，则必然做过旋转调整。
  - 答案：错误。如果删除的是叶子节点，且删除之后没有出现失衡的情况，就不需要进行旋转调整。
  - ```mermaid
    graph TB
    A --> B
    A --> C
    C --> D(删除这个节点)

    ```

- （2010 期中）在（）中越深的节点必然越多。A：二叉树 B：AVL树 C：满二叉树 D：完全二叉树 E：以上皆非
  - 答案：C。ABD的最后一层的节点数可能会比倒数第二层少。我在这里想到一个很荒谬的比喻，但是太恶心了就不写出来了。
- （2010 期中）在包含2010个节点的AVL树中，最高与最低叶节点之间的深度差最高可达 A：8 B：9 C：10 D：11 E：以上皆非
  - 答案：由“最高深度差”可以联想到考察的是AVL树最瘦最倾斜最临界的极端情况，即$S(h)=fib(h+3)-1$的情况。此时我们已经知道节点数为2010了，因此可以尝试推算出$h$。考虑到选项里给的深度差都不太大，我们或许可以通过枚举来找到$h$。枚举斐波那契数列到18后，我们发现 $ S(14) < 2010 < S(15) $ ，因此，2010个节点没有达到高为15的AVL树的最低节点数要求，但超过了高为14的AVL树的最低节点数要求，因此这棵2010个节点的又高又瘦的树的 $h=14$ 。由 #习题解析7-12 ,AVL树的叶节点深度最少是 $⌈h/2⌉$ ，而深度最大的叶节点显然=树高=14，故所求结果为14-7=7 。

- （2010 期中）下图有可能是一棵刚做过BST 的 ()操作，但尚未旋转调整的AVL 树。A. delete(2) B.insert(3) C. delete(4) D.insert(5) E.insert(8)
  ```mermaid
  graph TD
  3-->1
  3-->7
  7-->6
  7-->8
  6-->5
  6-->nul
  ``` 
  - 答案：DA. 对于选项B，注意AVL先根据[[BST]]规则，在叶节点插入新节点，然后再进行旋转调整。如果insert(3)之后，未旋转之前，3是根节点，那么原树只能是空的。其他选项都很好判断，不说了。


[//begin]: # "Autogenerated link references for markdown compatibility"
[BST]: BST.md "BST"
[//end]: # "Autogenerated link references"